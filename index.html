<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тестовое задание - Delta</title>

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <table class="table">
        <thead class="table__header">
            <tr>
                <td>Показатель</td>
                <td class="table_blue">Текущий день</td>
                <td>Вчера</td>
                <td>Этот день недели</td>
            </tr>
        </thead>

        <tbody class="table__body">
            <tr>
                <td>
                    Выручка, руб
                </td>
                <td class="table_blue">
                    500 521
                </td>
                <td class="table_green">
                    480 521
                </td>
                <td class="table_red">
                    4 805 121
                </td>
            </tr>

            <tr class="table__chart">
                <td colspan="4"></td>
            </tr>

            <tr>
                <td>
                    Наличные
                </td>
                <td class="table_blue">
                    300 000
                </td>
                <td class="">
                    300 000
                </td>
                <td class="">
                    300 000
                </td>
            </tr>

            <tr class="table__chart">
                <td colspan="4"></td>
            </tr>
        </tbody>
    </table>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        let rows = document.querySelectorAll('tbody > tr:not(.table__chart)');

        rows.forEach((row, index) => {
            row.onclick = function () {
                let current = Number(row.querySelector('td:nth-child(2)').textContent.trim().split(' ').join('')),
                    yesterday = Number(row.querySelector('td:nth-child(3)').textContent.trim().split(' ').join('')),
                    thisDay = Number(row.querySelector('td:nth-child(4)').textContent.trim().split(' ').join('')),
                    nextElement = row.nextElementSibling;
                
                if (nextElement.style.display == '') {
                    nextElement.style.display = 'table-row';

                    test(nextElement.querySelector('td'), current, yesterday, thisDay);
                }else{
                    nextElement.style.display = '';
                }
            }
        })


        function test(where, current, yesterday, thisDay) {
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);

            function drawChart() {
                let data = new google.visualization.DataTable();
                data.addColumn('string', 'Показатели'); 
                data.addColumn('number', 'Значение');

                data.addRows([
                    ['Текущий день', current],
                    ['Вчера', yesterday],
                    ['Этот день недели', thisDay],
                ]);

                // Настройки графика
                let options = {
                    width: 1400,
                    height: 500,
                    curveType: 'none',
                    legend: { position: 'none' },
                    hAxis: { title: 'Показатели' },
                    vAxis: { title: 'Значения' },
                    pointSize: 5,
                    colors: ['#037D50'],
                };

                let chart = new google.visualization.LineChart(where);
                chart.draw(data, options);
            }
        }
    </script>
</body>
</html>